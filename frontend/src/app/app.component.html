<div class="page">
  <div class="image-container">
    <img src="assets/obaid.png" alt="Obaid" class="main-image" />
  </div>
  <div class="chat-area">
    <div class="chat-background" [style.background-image]="'url(assets/obaid.png)'"></div>
    <div class="chat-header">
      <div class="header-content">
        <img src="assets/obaid.png" alt="Obaid" class="header-icon" />
        <span class="header-title">OBAID</span>
      </div>
    </div>
    <div class="messages" #messagesContainer>
      @for (message of chat.messages(); track trackByMessage($index, message)) {
        <div class="message" [attr.data-from]="message.from">
          @if (message.from === 'diabo') {
            <img src="assets/obaid.png" alt="Obaid" class="message-icon" />
          }
          <div class="bubble">{{ message.text }}</div>
        </div>
      }
      @if (chat.isLoading()) {
        <div class="message" data-from="diabo">
          <div class="bubble typing">Obaid est√° pensando...</div>
        </div>
      }
    </div>

    <div class="composer">
      <div class="input-wrapper">
        <div class="input-container" [class.has-hidden-text]="chat.hasHiddenText()">
          <input 
            type="text" 
            [value]="chat.inputText()" 
            (input)="chat.handleInputChange($any($event.target).value)"
            (keyup.enter)="chat.sendMessage()"
            placeholder="Enter your message..." 
            class="input-field"
            [style.caret-color]="chat.hasHiddenText() ? 'transparent' : 'auto'"
          />
          @if (chat.hasHiddenText()) {
            <span class="visible-text-overlay">{{ chat.visibleText() }}</span>
          }
        </div>
        @if (chat.hasHiddenText()) {
          <span class="hidden-indicator">Texto oculto ativo</span>
        }
      </div>
      <button (click)="chat.sendMessage()" [disabled]="!chat.canSend()">RESPONDER</button>
    </div>
  </div>
</div>
