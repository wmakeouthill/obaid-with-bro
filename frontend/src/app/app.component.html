<div class="page">
  <div class="diabo-area">
    <svg class="diabo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Figura do diabo">
      <circle cx="100" cy="100" r="80" fill="#a00000" />
      <circle cx="70" cy="80" r="10" fill="#000" />
      <circle cx="130" cy="80" r="10" fill="#000" />
      <path d="M60 60 C50 40, 30 30, 20 20" stroke="#600" stroke-width="6" fill="none"/>
      <path d="M140 60 C150 40, 170 30, 180 20" stroke="#600" stroke-width="6" fill="none"/>
      <path d="M70 140 C90 160, 110 160, 130 140" stroke="#300" stroke-width="8" fill="none" stroke-linecap="round"/>
    </svg>
  </div>

  <div class="chat-area">
    <div class="messages">
      @for (message of chat.messages(); track trackByMessage($index, message)) {
        <div class="message" [attr.data-from]="message.from">
          <div class="bubble">{{ message.text }}</div>
        </div>
      }
      @if (chat.isLoading()) {
        <div class="message" data-from="diabo">
          <div class="bubble typing">Obaid est√° pensando...</div>
        </div>
      }
    </div>

    <div class="composer">
      <div class="input-wrapper">
        <input 
          type="text" 
          [value]="chat.inputText()" 
          (input)="chat.handleInputChange($any($event.target).value)"
          (keydown)="chat.handleKeyPress($event)"
          (keyup.enter)="chat.sendMessage()"
          [class.hidden-typing]="chat.isTypingHidden()"
          placeholder="Fale com o Obaid... (pressione ; para ocultar)" 
        />
        @if (chat.isTypingHidden()) {
          <span class="hidden-indicator">Texto oculto ativo</span>
        }
      </div>
      <button (click)="chat.sendMessage()" [disabled]="!chat.canSend()">Enviar</button>
    </div>
  </div>
</div>
